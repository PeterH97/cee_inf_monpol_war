---
title: "Descriptives, Tech Summary and Preliminary Estimates"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      eval = TRUE,
                      fig.width = 15, 
                      fig.height = 10)
library(tidyverse)
library(readr)
```
# Descriptives

## Inflation peak

Inflation rates peaked around late 2022, early 2023. In all countries of the sample, the spike in energy prices was several times larger compared to the headline inflation rate, especially in the Baltic states, with energy inflation in Estonia reaching over 120% year-on-year. The core inflation rates at the time were more moderate, around half of the headline inflation.

```{r, fig.cap='Inflation rates at the peak of headline inflation' }
read_rds(file.path('descriptives', 'peak_inflation.rds')) %>%    
  ggplot(aes(x = country, y = value, fill = coicop, group = coicop)) +
  geom_col(position = 'dodge', color = 'black') +
  geom_text(aes(y = -5, label = date , angle = 30)) +
  theme_minimal() +
  theme(legend.position = 'bottom',
        legend.title = element_blank()) +
  labs(x = '',
       y = '')

```

## Economic activity

The rebound after the covid shock is apparent across all of our countries both from GDP growth and estimated output gap data. The GDP growth data shows the "excess demand" generated by covid relief measures as well as accumulated savings, however, in all countries economic activity started to cool off prior to the breakout of the war, and growth has been declining steadily since. The estimated output gaps are near zero, however that is potentially a fault of the estimation (HP filter end-point problem). 

```{r fig.cap='GDP growth and output gap'}
read_rds(file.path('descriptives', 'output_gap.rds')) %>%    
  ggplot(aes(x = date, y = value, color = side)) +
  geom_line(linewidth = .75) + 
  facet_wrap(~country, scales = 'free') +
  theme_minimal() +
  theme(legend.title = element_blank(),
        legend.position = 'bottom') +
  labs(x = '',
       y= '')

```

## Interest rate hikes

The graph below shows the accumulated change in interest rates from January of 2022 to the end of our sample (as of now, 2023 November). Out of all countries in the region, the Central Bank of Hungary has been raising rates the most aggressively - unsurprisingly as a response to the largest inflation rate observed in the region.

```{r, fig.cap='Rate hikes'}
read_rds(file.path('descriptives', 'ratehikes.rds')) %>%     
  ggplot(aes(x = fct_reorder(country, r), y = r, fill = r)) +
  geom_col() +
  coord_flip() +
  theme_minimal() +
  labs(x = '', 
       y = 'Accumulated change in interest rates since 2022') +
  scale_fill_distiller(direction = 1) + 
  theme(legend.position = 'none')

```

## Exchange rates

The graph below shows the change in REER and NEER indicators of the CEE countries since 2022 (January 2022 = 100%). Appreciation in real terms over the long run can be observed in all countries, as well as short term nominal depreciation in most. Members of the European Monetary Union have been more resilient to external shocks, as such countries faced more moderate depreciation in their nominal exchange rates. Hungary seemed to have been the most vulnerable to the war shock, with the largest nominal depreciation, as well as a short run real depreciation. 

```{r, fig.cap ='Real and Nominal Effective Exchange Rates'}
read_rds(file.path('descriptives', 'exchrates.rds')) %>%     
  ggplot(aes(x = date, y = value, color = var)) +
  geom_line(linewidth = .75) + 
  facet_wrap(~country) +
  theme_minimal() +
  theme(legend.title = element_blank(),
        legend.position = 'bottom') +
  labs(x = '',
       y = '') +
  scale_color_manual(values = c('Red', 'Blue'))


```

## Real wages

The graph below shows the change in real wage rates from the beginning of 2022 (2022 January = 100%) as of the end of our sample (2023 Q2). Labor markets show mixed outcomes, as almost half of our sample has accumulated moderate growth in real wages, while 7 out of 12 countries faced minimal to more severe welfare loss in the form of real wage decline.

```{r, fig.cap='Real wage growth.'}

read_rds(file.path('descriptives', 'wages.rds')) %>%     
  ggplot(aes(x = fct_reorder(country, -(wage-100)), y = wage-100, fill = wage-100)) + 
  geom_col() +
  theme_minimal() +
  theme(legend.position = 'none') +
  labs(x = '',
       y = '') +
  scale_fill_distiller(direction = -1)

```

# Preliminary estimates and tech summary

## Decomposing the headline inflation rate

I run a Fixed Effects OLS regression across our country panel to determine the contribution of core, food, and energy inflation rates to the headline harmonized CPI inflation (all data are from Eurostat). 

$CPI_{i,t} = \beta_{1}CORE_{i,t} + \beta_{2}FOOD_{i,t} + \beta_{3}ENERGY_{i,t}+  \delta_{i} + \gamma_{t} + \epsilon_{i,t}$

where $\delta_{i}$ are country fixed effects, $\gamma_{t}$ are annual fixed effects and $\beta_{j}$ reference the weight of each component in the headline inflation rate.

```{r}
infl <- read_rds('determinants of inflation/infl_decomp.rds')
```

Below are the results for the last four years of the sample (2019-2023):

```{r, fig.cap='Contribution of Core inflation, Food and Energy prices to headline inflation rates.'}
infl %>% 
  ggplot(aes(x = date)) +
  geom_col(aes(y = contrib, fill = var), color = 'white') +
  geom_line(aes(y = CP00), linewidth = .75) + 
  facet_wrap(~country, scales = 'free'
  ) +
  theme_minimal() +
  theme(legend.position = 'bottom') +
  scale_fill_brewer(palette = 'Dark2', 'Contribution to\nheadline inflation', direction = -1) +
  labs(x = '',
       y = '')
```

Same plot with fixed "Y" axis:

```{r, fig.cap='Contribution of Core inflation, Food and Energy prices to headline inflation rates, fixed Y axis.'   }
infl %>% 
  ggplot(aes(x = date)) +
  geom_col(aes(y = contrib, fill = var), color = 'white') +
  geom_line(aes(y = CP00), linewidth = .75) + 
  facet_wrap(~country, scales = 'free_x'
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = 'Dark2', 'Contribution to\nheadline inflation', direction = -1) +
  labs(x = '',
       y = '')
```

Potential follow-up:

Mediation analysis (/ an instrumental variable approach) could show if there is any inter-play among the rates. It is not too unreasonable to believe that government measures, such as price caps were instead realized in growth of non-targeted goods. For example, price caps on food or fuel items - resulting in revenue losses - were recouped by firms via increasing the prices of items found in the core CPI basket. This could be done by regressing each component on the other components and accounting for the indirect effects.


## Real rates, equilibrium and policy stance

Here I first calculate real interest rates as $r_{t} = i_{t} - \pi_{t+1}$, where $r_{t}$ is the real rate, $i_{t}$ is the nominal rate and $\pi_{t}$ is the annualized CPI inflation rate. The graph below shows the real rates across the countries in the sample:

```{r}
real_rate <- read_rds('real rate/real_rate.rds')
```

```{r, fig.cap= 'Real rates across countries.'}
real_rate %>% 
  ggplot(aes(x = date, y = r)) +
  geom_line(linewidth = .75)+
  facet_wrap(~country, scales = 'free_x') +
  theme_minimal() +
  labs(x = '', 
       y = '')
```

To separate the natural rate from cyclical fluctuations, I use two variations of the HP filter, a One-sided, and a Two-sided version. The two approaches yield similar trends, with the one sided (naturally) showing more fluctuations. The trend component estimated with the filters can be considered as the equilibrium real interes rate, these can be seen in the graph below:
```{r, fig.cap='Natural real interest rates.'}
real_rate %>% 
  select(country, date, r_trend1, r_trend2) %>% 
  gather(filter, value, starts_with('r')) %>% 
  mutate(filter = case_when(filter == 'r_trend1' ~ 'One-sided HP',
                            filter == 'r_trend2' ~ 'Two-sided HP')) %>% 
  ggplot(aes(x = date, y = value, color = filter)) +
  geom_line(linewidth = .75) +
  facet_wrap(~country, scales = 'free') +
  theme_minimal() +
  theme(legend.title = element_blank(),
        legend.position = 'bottom') +
  labs(x = '',
       y = '') +
  scale_color_manual(breaks = c('One-sided HP', 'Two-sided HP'),
                     values = c('red', 'darkblue'))

```
The graphs here show a historically declining equilibrium rate up to 2019/2020, where we can observe a reversion in this trend.

The deviations from the trend, i.e. the cyclical components thus can be used to asses policy stance:
```{r 'Policy stance - deviation from the equilibrium.'}
real_rate %>% 
  select(country, date, r_cycle1, r_cycle2) %>% 
  gather(filter, value, starts_with('r')) %>% 
  mutate(filter = case_when(filter == 'r_cycle1' ~ 'One-sided HP',
                            filter == 'r_cycle2' ~ 'Two-sided HP')) %>% 
  ggplot(aes(x = date, y = value, color = filter)) +
  geom_line(linewidth = .75) +
  facet_wrap(~country, scales = 'free') +
  theme_minimal() +
  theme(legend.title = element_blank(),
        legend.position = 'bottom') +
  labs(x = '',
       y = '') +
  scale_color_manual(breaks = c('One-sided HP', 'Two-sided HP'),
                     values = c('red', 'darkblue'))

```
All graphs here agree that policy stance was following a very loose monetary policy around 2-8 percent below the equilibrium, at the time the war shock hit the economies. The graphs also show the fast response of the regional central banks, as the real rate gaps rose sharply in the following months.
